{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\nimport { toRefs, ref, watch, onMounted, computed } from \"vue\";\nimport { isUndefined } from \"../../_utils/is.js\";\n\nfunction getPath(data, key) {\n  const path = [];\n\n  const loop = list => {\n    for (let i = 0; i < list.length; i++) {\n      const item = list[i];\n\n      if (item.key === key) {\n        return true;\n      }\n\n      if (item.children) {\n        path.push(item.key);\n        const matched = loop(item.children);\n\n        if (matched) {\n          return true;\n        }\n\n        path.pop();\n      }\n    }\n\n    return false;\n  };\n\n  loop(data);\n  return path;\n}\n\nfunction isSameKeys(keys1, keys2) {\n  if (keys1.length !== keys2.length) return false;\n  return keys1.toString() === keys2.toString();\n}\n\nfunction useMenuOpenState(props) {\n  const {\n    modelValue,\n    defaultValue,\n    autoOpen,\n    autoOpenSelected,\n    subMenuKeys,\n    selectedKeys,\n    menuData,\n    accordion\n  } = toRefs(props);\n  const localValue = ref(!isUndefined(modelValue.value) ? modelValue.value : !isUndefined(defaultValue.value) ? defaultValue.value : []);\n\n  const setLocalValue = val => {\n    localValue.value = val;\n  };\n\n  watch(modelValue, () => {\n    if (isUndefined(modelValue.value)) {\n      setLocalValue([]);\n    }\n  });\n  let mountedSubMenuKeys = [];\n  onMounted(() => {\n    mountedSubMenuKeys = [...subMenuKeys.value];\n    let newOpenKeys = [];\n\n    if (autoOpen.value) {\n      newOpenKeys = accordion.value ? subMenuKeys.value.slice(0, 1) : [...subMenuKeys.value];\n    }\n\n    if (autoOpenSelected.value) {\n      const pathList = selectedKeys.value.map(key => getPath(menuData.value, key));\n\n      if (pathList.length && (!autoOpen.value || accordion.value)) {\n        newOpenKeys = accordion.value ? pathList[0] : [...new Set([].concat(...pathList))];\n      }\n    }\n\n    if (newOpenKeys.length) {\n      setLocalValue(newOpenKeys);\n    }\n  });\n  let hasTriggered = false;\n  watch(subMenuKeys, (currentKeys, prevKeys = []) => {\n    if (hasTriggered || !isSameKeys(currentKeys, mountedSubMenuKeys)) {\n      const newOpenKeys = openKeys.value.filter(key => currentKeys.includes(key));\n\n      if (autoOpen.value) {\n        const keysAdded = currentKeys.filter(key => !prevKeys.includes(key));\n        newOpenKeys.push(...keysAdded);\n      }\n\n      setLocalValue(accordion.value ? newOpenKeys.slice(0, 1) : newOpenKeys);\n    }\n\n    hasTriggered = true;\n  });\n  const openKeys = computed(() => modelValue.value || localValue.value);\n  return {\n    openKeys,\n    localOpenKeys: localValue,\n    setOpenKeys: setLocalValue,\n\n    open(key, level) {\n      let newOpenKeys = [];\n\n      if (openKeys.value.indexOf(key) > -1) {\n        if (accordion.value && level === 1) {\n          newOpenKeys = [];\n        } else {\n          newOpenKeys = openKeys.value.filter(i => i !== key);\n        }\n      } else if (accordion.value && level === 1) {\n        newOpenKeys = [key];\n      } else {\n        newOpenKeys = openKeys.value.concat([key]);\n      }\n\n      setLocalValue(newOpenKeys);\n      return newOpenKeys;\n    }\n\n  };\n}\n\nexport { useMenuOpenState as default };","map":{"version":3,"names":["toRefs","ref","watch","onMounted","computed","isUndefined","getPath","data","key","path","loop","list","i","length","item","children","push","matched","pop","isSameKeys","keys1","keys2","toString","useMenuOpenState","props","modelValue","defaultValue","autoOpen","autoOpenSelected","subMenuKeys","selectedKeys","menuData","accordion","localValue","value","setLocalValue","val","mountedSubMenuKeys","newOpenKeys","slice","pathList","map","Set","concat","hasTriggered","currentKeys","prevKeys","openKeys","filter","includes","keysAdded","localOpenKeys","setOpenKeys","open","level","indexOf","default"],"sources":["/www/wwwroot/admin/node_modules/@arco-design/web-vue/es/menu/hooks/use-menu-open-state.js"],"sourcesContent":["import { toRefs, ref, watch, onMounted, computed } from \"vue\";\nimport { isUndefined } from \"../../_utils/is.js\";\nfunction getPath(data, key) {\n  const path = [];\n  const loop = (list) => {\n    for (let i = 0; i < list.length; i++) {\n      const item = list[i];\n      if (item.key === key) {\n        return true;\n      }\n      if (item.children) {\n        path.push(item.key);\n        const matched = loop(item.children);\n        if (matched) {\n          return true;\n        }\n        path.pop();\n      }\n    }\n    return false;\n  };\n  loop(data);\n  return path;\n}\nfunction isSameKeys(keys1, keys2) {\n  if (keys1.length !== keys2.length)\n    return false;\n  return keys1.toString() === keys2.toString();\n}\nfunction useMenuOpenState(props) {\n  const {\n    modelValue,\n    defaultValue,\n    autoOpen,\n    autoOpenSelected,\n    subMenuKeys,\n    selectedKeys,\n    menuData,\n    accordion\n  } = toRefs(props);\n  const localValue = ref(!isUndefined(modelValue.value) ? modelValue.value : !isUndefined(defaultValue.value) ? defaultValue.value : []);\n  const setLocalValue = (val) => {\n    localValue.value = val;\n  };\n  watch(modelValue, () => {\n    if (isUndefined(modelValue.value)) {\n      setLocalValue([]);\n    }\n  });\n  let mountedSubMenuKeys = [];\n  onMounted(() => {\n    mountedSubMenuKeys = [...subMenuKeys.value];\n    let newOpenKeys = [];\n    if (autoOpen.value) {\n      newOpenKeys = accordion.value ? subMenuKeys.value.slice(0, 1) : [...subMenuKeys.value];\n    }\n    if (autoOpenSelected.value) {\n      const pathList = selectedKeys.value.map((key) => getPath(menuData.value, key));\n      if (pathList.length && (!autoOpen.value || accordion.value)) {\n        newOpenKeys = accordion.value ? pathList[0] : [...new Set([].concat(...pathList))];\n      }\n    }\n    if (newOpenKeys.length) {\n      setLocalValue(newOpenKeys);\n    }\n  });\n  let hasTriggered = false;\n  watch(subMenuKeys, (currentKeys, prevKeys = []) => {\n    if (hasTriggered || !isSameKeys(currentKeys, mountedSubMenuKeys)) {\n      const newOpenKeys = openKeys.value.filter((key) => currentKeys.includes(key));\n      if (autoOpen.value) {\n        const keysAdded = currentKeys.filter((key) => !prevKeys.includes(key));\n        newOpenKeys.push(...keysAdded);\n      }\n      setLocalValue(accordion.value ? newOpenKeys.slice(0, 1) : newOpenKeys);\n    }\n    hasTriggered = true;\n  });\n  const openKeys = computed(() => modelValue.value || localValue.value);\n  return {\n    openKeys,\n    localOpenKeys: localValue,\n    setOpenKeys: setLocalValue,\n    open(key, level) {\n      let newOpenKeys = [];\n      if (openKeys.value.indexOf(key) > -1) {\n        if (accordion.value && level === 1) {\n          newOpenKeys = [];\n        } else {\n          newOpenKeys = openKeys.value.filter((i) => i !== key);\n        }\n      } else if (accordion.value && level === 1) {\n        newOpenKeys = [key];\n      } else {\n        newOpenKeys = openKeys.value.concat([key]);\n      }\n      setLocalValue(newOpenKeys);\n      return newOpenKeys;\n    }\n  };\n}\nexport { useMenuOpenState as default };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}