{"ast":null,"code":"import \"core-js/modules/es.array.includes.js\";\nimport { toRefs, computed, reactive, nextTick } from \"vue\";\nimport pick from \"../../_utils/pick.js\";\nimport { methods, getSortedDayjsArray } from \"../../_utils/date.js\";\nimport usePanelSpan from \"./use-panel-span.js\";\nimport useHeaderValue from \"./use-header-value.js\";\n\nfunction useRangeHeaderValue(props) {\n  const {\n    mode,\n    value,\n    defaultValue,\n    selectedValue,\n    format,\n    onChange\n  } = toRefs(props);\n  const unit = computed(() => [\"date\", \"week\"].includes(mode.value) ? \"M\" : \"y\");\n\n  const isSame = (current, target) => current.isSame(target, unit.value);\n\n  const {\n    span,\n    superSpan\n  } = usePanelSpan(reactive({\n    mode\n  }));\n  const startValue = computed(() => {\n    var _a;\n\n    return (_a = value.value) == null ? void 0 : _a[0];\n  });\n  const endValue = computed(() => {\n    var _a;\n\n    return (_a = value.value) == null ? void 0 : _a[1];\n  });\n  const startDefaultValue = computed(() => {\n    var _a;\n\n    return (_a = defaultValue.value) == null ? void 0 : _a[0];\n  });\n  const endDefaultValue = computed(() => {\n    var _a;\n\n    return (_a = defaultValue.value) == null ? void 0 : _a[1];\n  });\n\n  const emitChange = newVal => {\n    (onChange == null ? void 0 : onChange.value) && onChange.value(newVal);\n  };\n\n  const [startHeaderValue, setStartHeaderValue, startHeaderOperations,, getDefaultStartHeaderValue] = useHeaderValue(reactive({\n    mode,\n    value: startValue,\n    defaultValue: startDefaultValue,\n    selectedValue: void 0,\n    format,\n    onChange: newVal => {\n      emitChange([newVal, endHeaderValue.value]);\n    }\n  }));\n  const [endHeaderValue, setEndHeaderValue, endHeaderOperations,, getDefaultEndHeaderValue] = useHeaderValue(reactive({\n    mode,\n    value: endValue,\n    defaultValue: endDefaultValue,\n    selectedValue: void 0,\n    format,\n    onChange: newVal => {\n      emitChange([startHeaderValue.value, newVal]);\n    }\n  }));\n\n  const setHeaderValue = newVal => {\n    const isSameStartValue = isSame(startHeaderValue.value, newVal[0]);\n    const isSameEndValue = isSame(endHeaderValue.value, newVal[1]);\n    setStartHeaderValue(newVal[0], false);\n    setEndHeaderValue(newVal[1], false);\n\n    if (!isSameStartValue || !isSameEndValue) {\n      (onChange == null ? void 0 : onChange.value) && (onChange == null ? void 0 : onChange.value(newVal));\n    }\n  };\n\n  function getFixedValue(values) {\n    let [header02, header12] = getSortedDayjsArray(values);\n    const nextHeader = methods.add(header02, span.value, \"M\");\n\n    if (header12.isBefore(nextHeader, unit.value)) {\n      header12 = nextHeader;\n    }\n\n    return [header02, header12];\n  }\n\n  function getFormSelectedValue() {\n    var _a, _b;\n\n    let selected02 = (_a = selectedValue.value) == null ? void 0 : _a[0];\n    let selected12 = (_b = selectedValue.value) == null ? void 0 : _b[1];\n\n    if (selected02 && selected12) {\n      [selected02, selected12] = getSortedDayjsArray([selected02, selected12]);\n    }\n\n    return [selected02, selected12];\n  }\n\n  const [selected0, selected1] = getFormSelectedValue();\n  const [header0, header1] = getFixedValue([selected0 || startHeaderValue.value, selected1 || endHeaderValue.value]);\n  setStartHeaderValue(header0, false);\n  setEndHeaderValue(header1, false);\n\n  const resetHeaderValue = () => {\n    const defaultStartHeaderValue = getDefaultStartHeaderValue();\n    const defaultEndHeaderValue = getDefaultEndHeaderValue();\n    nextTick(() => {\n      const [selected02, selected12] = getFormSelectedValue();\n      const [header02, header12] = getFixedValue([selected02 || defaultStartHeaderValue, selected12 || defaultEndHeaderValue]);\n      setHeaderValue([header02, header12]);\n    });\n  };\n\n  const canShortenMonth = computed(() => methods.add(startHeaderValue.value, span.value, \"M\").isBefore(endHeaderValue.value, unit.value));\n  const canShortenYear = computed(() => methods.add(startHeaderValue.value, superSpan.value, \"M\").isBefore(endHeaderValue.value, unit.value));\n  const computedStartHeaderOperations = computed(() => {\n    const operations = [\"onSuperPrev\", \"onPrev\"];\n    if (canShortenMonth.value) operations.push(\"onNext\");\n    if (canShortenYear.value) operations.push(\"onSuperNext\");\n    return pick(startHeaderOperations.value, operations);\n  });\n  const computedEndHeaderOperations = computed(() => {\n    const operations = [\"onSuperNext\", \"onNext\"];\n    if (canShortenMonth.value) operations.push(\"onPrev\");\n    if (canShortenYear.value) operations.push(\"onSuperPrev\");\n    return pick(endHeaderOperations.value, operations);\n  });\n  return {\n    startHeaderValue,\n    endHeaderValue,\n    startHeaderOperations: computedStartHeaderOperations,\n    endHeaderOperations: computedEndHeaderOperations,\n    setHeaderValue,\n    resetHeaderValue\n  };\n}\n\nexport { useRangeHeaderValue as default };","map":{"version":3,"names":["toRefs","computed","reactive","nextTick","pick","methods","getSortedDayjsArray","usePanelSpan","useHeaderValue","useRangeHeaderValue","props","mode","value","defaultValue","selectedValue","format","onChange","unit","includes","isSame","current","target","span","superSpan","startValue","_a","endValue","startDefaultValue","endDefaultValue","emitChange","newVal","startHeaderValue","setStartHeaderValue","startHeaderOperations","getDefaultStartHeaderValue","endHeaderValue","setEndHeaderValue","endHeaderOperations","getDefaultEndHeaderValue","setHeaderValue","isSameStartValue","isSameEndValue","getFixedValue","values","header02","header12","nextHeader","add","isBefore","getFormSelectedValue","_b","selected02","selected12","selected0","selected1","header0","header1","resetHeaderValue","defaultStartHeaderValue","defaultEndHeaderValue","canShortenMonth","canShortenYear","computedStartHeaderOperations","operations","push","computedEndHeaderOperations","default"],"sources":["/www/wwwroot/admin/node_modules/@arco-design/web-vue/es/date-picker/hooks/use-range-header-value.js"],"sourcesContent":["import { toRefs, computed, reactive, nextTick } from \"vue\";\nimport pick from \"../../_utils/pick.js\";\nimport { methods, getSortedDayjsArray } from \"../../_utils/date.js\";\nimport usePanelSpan from \"./use-panel-span.js\";\nimport useHeaderValue from \"./use-header-value.js\";\nfunction useRangeHeaderValue(props) {\n  const { mode, value, defaultValue, selectedValue, format, onChange } = toRefs(props);\n  const unit = computed(() => [\"date\", \"week\"].includes(mode.value) ? \"M\" : \"y\");\n  const isSame = (current, target) => current.isSame(target, unit.value);\n  const { span, superSpan } = usePanelSpan(reactive({\n    mode\n  }));\n  const startValue = computed(() => {\n    var _a;\n    return (_a = value.value) == null ? void 0 : _a[0];\n  });\n  const endValue = computed(() => {\n    var _a;\n    return (_a = value.value) == null ? void 0 : _a[1];\n  });\n  const startDefaultValue = computed(() => {\n    var _a;\n    return (_a = defaultValue.value) == null ? void 0 : _a[0];\n  });\n  const endDefaultValue = computed(() => {\n    var _a;\n    return (_a = defaultValue.value) == null ? void 0 : _a[1];\n  });\n  const emitChange = (newVal) => {\n    (onChange == null ? void 0 : onChange.value) && onChange.value(newVal);\n  };\n  const [\n    startHeaderValue,\n    setStartHeaderValue,\n    startHeaderOperations,\n    ,\n    getDefaultStartHeaderValue\n  ] = useHeaderValue(reactive({\n    mode,\n    value: startValue,\n    defaultValue: startDefaultValue,\n    selectedValue: void 0,\n    format,\n    onChange: (newVal) => {\n      emitChange([newVal, endHeaderValue.value]);\n    }\n  }));\n  const [\n    endHeaderValue,\n    setEndHeaderValue,\n    endHeaderOperations,\n    ,\n    getDefaultEndHeaderValue\n  ] = useHeaderValue(reactive({\n    mode,\n    value: endValue,\n    defaultValue: endDefaultValue,\n    selectedValue: void 0,\n    format,\n    onChange: (newVal) => {\n      emitChange([startHeaderValue.value, newVal]);\n    }\n  }));\n  const setHeaderValue = (newVal) => {\n    const isSameStartValue = isSame(startHeaderValue.value, newVal[0]);\n    const isSameEndValue = isSame(endHeaderValue.value, newVal[1]);\n    setStartHeaderValue(newVal[0], false);\n    setEndHeaderValue(newVal[1], false);\n    if (!isSameStartValue || !isSameEndValue) {\n      (onChange == null ? void 0 : onChange.value) && (onChange == null ? void 0 : onChange.value(newVal));\n    }\n  };\n  function getFixedValue(values) {\n    let [header02, header12] = getSortedDayjsArray(values);\n    const nextHeader = methods.add(header02, span.value, \"M\");\n    if (header12.isBefore(nextHeader, unit.value)) {\n      header12 = nextHeader;\n    }\n    return [header02, header12];\n  }\n  function getFormSelectedValue() {\n    var _a, _b;\n    let selected02 = (_a = selectedValue.value) == null ? void 0 : _a[0];\n    let selected12 = (_b = selectedValue.value) == null ? void 0 : _b[1];\n    if (selected02 && selected12) {\n      [selected02, selected12] = getSortedDayjsArray([selected02, selected12]);\n    }\n    return [selected02, selected12];\n  }\n  const [selected0, selected1] = getFormSelectedValue();\n  const [header0, header1] = getFixedValue([\n    selected0 || startHeaderValue.value,\n    selected1 || endHeaderValue.value\n  ]);\n  setStartHeaderValue(header0, false);\n  setEndHeaderValue(header1, false);\n  const resetHeaderValue = () => {\n    const defaultStartHeaderValue = getDefaultStartHeaderValue();\n    const defaultEndHeaderValue = getDefaultEndHeaderValue();\n    nextTick(() => {\n      const [selected02, selected12] = getFormSelectedValue();\n      const [header02, header12] = getFixedValue([\n        selected02 || defaultStartHeaderValue,\n        selected12 || defaultEndHeaderValue\n      ]);\n      setHeaderValue([header02, header12]);\n    });\n  };\n  const canShortenMonth = computed(() => methods.add(startHeaderValue.value, span.value, \"M\").isBefore(endHeaderValue.value, unit.value));\n  const canShortenYear = computed(() => methods.add(startHeaderValue.value, superSpan.value, \"M\").isBefore(endHeaderValue.value, unit.value));\n  const computedStartHeaderOperations = computed(() => {\n    const operations = [\"onSuperPrev\", \"onPrev\"];\n    if (canShortenMonth.value)\n      operations.push(\"onNext\");\n    if (canShortenYear.value)\n      operations.push(\"onSuperNext\");\n    return pick(startHeaderOperations.value, operations);\n  });\n  const computedEndHeaderOperations = computed(() => {\n    const operations = [\"onSuperNext\", \"onNext\"];\n    if (canShortenMonth.value)\n      operations.push(\"onPrev\");\n    if (canShortenYear.value)\n      operations.push(\"onSuperPrev\");\n    return pick(endHeaderOperations.value, operations);\n  });\n  return {\n    startHeaderValue,\n    endHeaderValue,\n    startHeaderOperations: computedStartHeaderOperations,\n    endHeaderOperations: computedEndHeaderOperations,\n    setHeaderValue,\n    resetHeaderValue\n  };\n}\nexport { useRangeHeaderValue as default };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}