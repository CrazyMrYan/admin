{"ast":null,"code":"import { toRefs, computed, ref, watchEffect } from \"vue\";\nimport { debounce } from \"../../_utils/debounce.js\";\nimport { isUndefined } from \"../../_utils/is.js\";\n\nfunction useFilterTreeNode(props) {\n  const {\n    searchValue,\n    flattenTreeData,\n    filterMethod: propFilterMethod,\n    disableFilter,\n    fieldNames\n  } = toRefs(props);\n  const keyField = computed(() => {\n    var _a;\n\n    return ((_a = fieldNames.value) == null ? void 0 : _a.key) || \"key\";\n  });\n\n  const defaultFilterMethod = (keyword, node) => {\n    const key = node[keyField.value];\n    return !isUndefined(key) && String(key).indexOf(keyword) > -1;\n  };\n\n  const filterMethod = computed(() => (propFilterMethod == null ? void 0 : propFilterMethod.value) || defaultFilterMethod);\n  const filteredKeysSet = ref();\n  const isFiltering = computed(() => !!searchValue.value);\n  const isEmptyFilterResult = computed(() => !(disableFilter == null ? void 0 : disableFilter.value) && isFiltering.value && filteredKeysSet.value && filteredKeysSet.value.size === 0);\n  const filterTreeNode = computed(() => (disableFilter == null ? void 0 : disableFilter.value) ? void 0 : node => {\n    var _a;\n\n    if (!isFiltering.value) return true;\n    const key = node[keyField.value];\n    return (_a = filteredKeysSet.value) == null ? void 0 : _a.has(key || \"\");\n  });\n  const updateFilteredKeysSet = debounce((treeData, keyword) => {\n    const hitNodes = treeData.filter(node => filterMethod.value(keyword, node.treeNodeData));\n\n    const _keysSet = new Set();\n\n    hitNodes.forEach(node => {\n      _keysSet.add(node.key);\n\n      node.pathParentKeys.forEach(_key => {\n        _keysSet.add(_key);\n      });\n    });\n    filteredKeysSet.value = _keysSet;\n  }, 100);\n  watchEffect(() => {\n    if (disableFilter == null ? void 0 : disableFilter.value) {\n      filteredKeysSet.value = void 0;\n    } else {\n      updateFilteredKeysSet(flattenTreeData.value, searchValue.value);\n    }\n  });\n  return {\n    isEmptyFilterResult,\n    filterTreeNode\n  };\n}\n\nexport { useFilterTreeNode as default };","map":{"version":3,"names":["toRefs","computed","ref","watchEffect","debounce","isUndefined","useFilterTreeNode","props","searchValue","flattenTreeData","filterMethod","propFilterMethod","disableFilter","fieldNames","keyField","_a","value","key","defaultFilterMethod","keyword","node","String","indexOf","filteredKeysSet","isFiltering","isEmptyFilterResult","size","filterTreeNode","has","updateFilteredKeysSet","treeData","hitNodes","filter","treeNodeData","_keysSet","Set","forEach","add","pathParentKeys","_key","default"],"sources":["/www/wwwroot/admin/node_modules/@arco-design/web-vue/es/tree-select/hooks/use-filter-tree-node.js"],"sourcesContent":["import { toRefs, computed, ref, watchEffect } from \"vue\";\nimport { debounce } from \"../../_utils/debounce.js\";\nimport { isUndefined } from \"../../_utils/is.js\";\nfunction useFilterTreeNode(props) {\n  const {\n    searchValue,\n    flattenTreeData,\n    filterMethod: propFilterMethod,\n    disableFilter,\n    fieldNames\n  } = toRefs(props);\n  const keyField = computed(() => {\n    var _a;\n    return ((_a = fieldNames.value) == null ? void 0 : _a.key) || \"key\";\n  });\n  const defaultFilterMethod = (keyword, node) => {\n    const key = node[keyField.value];\n    return !isUndefined(key) && String(key).indexOf(keyword) > -1;\n  };\n  const filterMethod = computed(() => (propFilterMethod == null ? void 0 : propFilterMethod.value) || defaultFilterMethod);\n  const filteredKeysSet = ref();\n  const isFiltering = computed(() => !!searchValue.value);\n  const isEmptyFilterResult = computed(() => !(disableFilter == null ? void 0 : disableFilter.value) && isFiltering.value && filteredKeysSet.value && filteredKeysSet.value.size === 0);\n  const filterTreeNode = computed(() => (disableFilter == null ? void 0 : disableFilter.value) ? void 0 : (node) => {\n    var _a;\n    if (!isFiltering.value)\n      return true;\n    const key = node[keyField.value];\n    return (_a = filteredKeysSet.value) == null ? void 0 : _a.has(key || \"\");\n  });\n  const updateFilteredKeysSet = debounce((treeData, keyword) => {\n    const hitNodes = treeData.filter((node) => filterMethod.value(keyword, node.treeNodeData));\n    const _keysSet = new Set();\n    hitNodes.forEach((node) => {\n      _keysSet.add(node.key);\n      node.pathParentKeys.forEach((_key) => {\n        _keysSet.add(_key);\n      });\n    });\n    filteredKeysSet.value = _keysSet;\n  }, 100);\n  watchEffect(() => {\n    if (disableFilter == null ? void 0 : disableFilter.value) {\n      filteredKeysSet.value = void 0;\n    } else {\n      updateFilteredKeysSet(flattenTreeData.value, searchValue.value);\n    }\n  });\n  return {\n    isEmptyFilterResult,\n    filterTreeNode\n  };\n}\nexport { useFilterTreeNode as default };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}