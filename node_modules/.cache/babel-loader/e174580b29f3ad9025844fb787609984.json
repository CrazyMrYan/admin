{"ast":null,"code":"import { toRefs, computed, reactive, ref, watch } from \"vue\";\nimport { getDayjsValue, getNow, methods } from \"../../_utils/date.js\";\nimport usePanelSpan from \"./use-panel-span.js\";\n\nfunction useHeaderValue(props) {\n  const {\n    mode,\n    value,\n    defaultValue,\n    selectedValue,\n    format,\n    onChange\n  } = toRefs(props);\n  const computedMode = computed(() => (mode == null ? void 0 : mode.value) || \"date\");\n  const {\n    span,\n    superSpan\n  } = usePanelSpan(reactive({\n    mode: computedMode\n  }));\n\n  const isSame = (current, target) => {\n    const unit = computedMode.value === \"date\" || computedMode.value === \"week\" ? \"M\" : \"y\";\n    return current.isSame(target, unit);\n  };\n\n  const computedValue = computed(() => getDayjsValue(value == null ? void 0 : value.value, format.value));\n  const computedDefaultValue = computed(() => getDayjsValue(defaultValue == null ? void 0 : defaultValue.value, format.value));\n  const localValue = ref(computedDefaultValue.value || getNow());\n  const headerValue = computed(() => computedValue.value || localValue.value);\n\n  const setLocalValue = newVal => {\n    if (!newVal) return;\n    localValue.value = newVal;\n  };\n\n  const setHeaderValue = (newVal, emitChange = true) => {\n    var _a;\n\n    if (!newVal) return;\n\n    if (emitChange && !isSame(headerValue.value, newVal)) {\n      (_a = onChange == null ? void 0 : onChange.value) == null ? void 0 : _a.call(onChange, newVal);\n    }\n\n    setLocalValue(newVal);\n  };\n\n  if (selectedValue == null ? void 0 : selectedValue.value) {\n    setLocalValue(selectedValue.value);\n  }\n\n  watch(() => selectedValue == null ? void 0 : selectedValue.value, newVal => {\n    setHeaderValue(newVal);\n  });\n\n  function getDefaultLocalValue() {\n    return (selectedValue == null ? void 0 : selectedValue.value) || computedDefaultValue.value || getNow();\n  }\n\n  function resetHeaderValue(emitChange = true) {\n    const defaultLocalValue = getDefaultLocalValue();\n\n    if (emitChange) {\n      setHeaderValue(defaultLocalValue);\n    } else {\n      setLocalValue(defaultLocalValue);\n    }\n  }\n\n  const showSingleBtn = computed(() => span.value !== superSpan.value);\n  const headerOperations = computed(() => ({\n    onSuperPrev: () => {\n      setHeaderValue(methods.subtract(headerValue.value, superSpan.value, \"M\"));\n    },\n    onPrev: showSingleBtn.value ? () => {\n      setHeaderValue(methods.subtract(headerValue.value, span.value, \"M\"));\n    } : void 0,\n    onNext: showSingleBtn.value ? () => {\n      setHeaderValue(methods.add(headerValue.value, span.value, \"M\"));\n    } : void 0,\n    onSuperNext: () => {\n      setHeaderValue(methods.add(headerValue.value, superSpan.value, \"M\"));\n    }\n  }));\n  return [headerValue, setHeaderValue, headerOperations, resetHeaderValue, getDefaultLocalValue];\n}\n\nexport { useHeaderValue as default };","map":{"version":3,"names":["toRefs","computed","reactive","ref","watch","getDayjsValue","getNow","methods","usePanelSpan","useHeaderValue","props","mode","value","defaultValue","selectedValue","format","onChange","computedMode","span","superSpan","isSame","current","target","unit","computedValue","computedDefaultValue","localValue","headerValue","setLocalValue","newVal","setHeaderValue","emitChange","_a","call","getDefaultLocalValue","resetHeaderValue","defaultLocalValue","showSingleBtn","headerOperations","onSuperPrev","subtract","onPrev","onNext","add","onSuperNext","default"],"sources":["/www/wwwroot/admin/node_modules/@arco-design/web-vue/es/date-picker/hooks/use-header-value.js"],"sourcesContent":["import { toRefs, computed, reactive, ref, watch } from \"vue\";\nimport { getDayjsValue, getNow, methods } from \"../../_utils/date.js\";\nimport usePanelSpan from \"./use-panel-span.js\";\nfunction useHeaderValue(props) {\n  const { mode, value, defaultValue, selectedValue, format, onChange } = toRefs(props);\n  const computedMode = computed(() => (mode == null ? void 0 : mode.value) || \"date\");\n  const { span, superSpan } = usePanelSpan(reactive({\n    mode: computedMode\n  }));\n  const isSame = (current, target) => {\n    const unit = computedMode.value === \"date\" || computedMode.value === \"week\" ? \"M\" : \"y\";\n    return current.isSame(target, unit);\n  };\n  const computedValue = computed(() => getDayjsValue(value == null ? void 0 : value.value, format.value));\n  const computedDefaultValue = computed(() => getDayjsValue(defaultValue == null ? void 0 : defaultValue.value, format.value));\n  const localValue = ref(computedDefaultValue.value || getNow());\n  const headerValue = computed(() => computedValue.value || localValue.value);\n  const setLocalValue = (newVal) => {\n    if (!newVal)\n      return;\n    localValue.value = newVal;\n  };\n  const setHeaderValue = (newVal, emitChange = true) => {\n    var _a;\n    if (!newVal)\n      return;\n    if (emitChange && !isSame(headerValue.value, newVal)) {\n      (_a = onChange == null ? void 0 : onChange.value) == null ? void 0 : _a.call(onChange, newVal);\n    }\n    setLocalValue(newVal);\n  };\n  if (selectedValue == null ? void 0 : selectedValue.value) {\n    setLocalValue(selectedValue.value);\n  }\n  watch(() => selectedValue == null ? void 0 : selectedValue.value, (newVal) => {\n    setHeaderValue(newVal);\n  });\n  function getDefaultLocalValue() {\n    return (selectedValue == null ? void 0 : selectedValue.value) || computedDefaultValue.value || getNow();\n  }\n  function resetHeaderValue(emitChange = true) {\n    const defaultLocalValue = getDefaultLocalValue();\n    if (emitChange) {\n      setHeaderValue(defaultLocalValue);\n    } else {\n      setLocalValue(defaultLocalValue);\n    }\n  }\n  const showSingleBtn = computed(() => span.value !== superSpan.value);\n  const headerOperations = computed(() => ({\n    onSuperPrev: () => {\n      setHeaderValue(methods.subtract(headerValue.value, superSpan.value, \"M\"));\n    },\n    onPrev: showSingleBtn.value ? () => {\n      setHeaderValue(methods.subtract(headerValue.value, span.value, \"M\"));\n    } : void 0,\n    onNext: showSingleBtn.value ? () => {\n      setHeaderValue(methods.add(headerValue.value, span.value, \"M\"));\n    } : void 0,\n    onSuperNext: () => {\n      setHeaderValue(methods.add(headerValue.value, superSpan.value, \"M\"));\n    }\n  }));\n  return [\n    headerValue,\n    setHeaderValue,\n    headerOperations,\n    resetHeaderValue,\n    getDefaultLocalValue\n  ];\n}\nexport { useHeaderValue as default };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}