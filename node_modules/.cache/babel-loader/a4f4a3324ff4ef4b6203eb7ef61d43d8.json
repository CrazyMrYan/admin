{"ast":null,"code":"import { toRefs, ref } from \"vue\";\nimport { throttleByRaf } from \"../../_utils/throttle-by-raf.js\";\nimport useTreeContext from \"./use-tree-context.js\";\n\nfunction useDraggable(props) {\n  const {\n    key,\n    refTitle\n  } = toRefs(props);\n  const treeContext = useTreeContext();\n  const isDragOver = ref(false);\n  const isDragging = ref(false);\n  const isAllowDrop = ref(false);\n  const dropPosition = ref(0);\n  const updateDropPosition = throttleByRaf(e => {\n    if (!refTitle.value) return;\n    const rect = refTitle.value.getBoundingClientRect();\n    const offsetY = window.pageYOffset + rect.top;\n    const {\n      pageY\n    } = e;\n    const gapHeight = rect.height / 4;\n    const diff = pageY - offsetY;\n    dropPosition.value = diff < gapHeight ? -1 : diff < rect.height - gapHeight ? 0 : 1;\n    isAllowDrop.value = treeContext.allowDrop ? treeContext.allowDrop(key.value, dropPosition.value) : true;\n  });\n  return {\n    isDragOver,\n    isDragging,\n    isAllowDrop,\n    dropPosition,\n\n    setDragStatus(status, e) {\n      switch (status) {\n        case \"dragStart\":\n          isDragging.value = true;\n          dropPosition.value = 0;\n          treeContext.onDragStart && treeContext.onDragStart(key.value, e);\n          break;\n\n        case \"dragEnd\":\n          isDragging.value = false;\n          isDragOver.value = false;\n          dropPosition.value = 0;\n          updateDropPosition.cancel();\n          treeContext.onDragEnd && treeContext.onDragEnd(key.value, e);\n          break;\n\n        case \"dragOver\":\n          isDragOver.value = true;\n          updateDropPosition(e);\n          treeContext.onDragOver && treeContext.onDragOver(key.value, e);\n          break;\n\n        case \"dragLeave\":\n          isDragOver.value = false;\n          dropPosition.value = 0;\n          updateDropPosition.cancel();\n          treeContext.onDragLeave && treeContext.onDragLeave(key.value, e);\n          break;\n\n        case \"drop\":\n          treeContext.onDrop && treeContext.onDrop(key.value, dropPosition.value, e);\n          isDragOver.value = false;\n          dropPosition.value = 0;\n          updateDropPosition.cancel();\n          break;\n      }\n    }\n\n  };\n}\n\nexport { useDraggable as default };","map":{"version":3,"names":["toRefs","ref","throttleByRaf","useTreeContext","useDraggable","props","key","refTitle","treeContext","isDragOver","isDragging","isAllowDrop","dropPosition","updateDropPosition","e","value","rect","getBoundingClientRect","offsetY","window","pageYOffset","top","pageY","gapHeight","height","diff","allowDrop","setDragStatus","status","onDragStart","cancel","onDragEnd","onDragOver","onDragLeave","onDrop","default"],"sources":["/www/wwwroot/admin/node_modules/@arco-design/web-vue/es/tree/hooks/use-draggable.js"],"sourcesContent":["import { toRefs, ref } from \"vue\";\nimport { throttleByRaf } from \"../../_utils/throttle-by-raf.js\";\nimport useTreeContext from \"./use-tree-context.js\";\nfunction useDraggable(props) {\n  const { key, refTitle } = toRefs(props);\n  const treeContext = useTreeContext();\n  const isDragOver = ref(false);\n  const isDragging = ref(false);\n  const isAllowDrop = ref(false);\n  const dropPosition = ref(0);\n  const updateDropPosition = throttleByRaf((e) => {\n    if (!refTitle.value)\n      return;\n    const rect = refTitle.value.getBoundingClientRect();\n    const offsetY = window.pageYOffset + rect.top;\n    const { pageY } = e;\n    const gapHeight = rect.height / 4;\n    const diff = pageY - offsetY;\n    dropPosition.value = diff < gapHeight ? -1 : diff < rect.height - gapHeight ? 0 : 1;\n    isAllowDrop.value = treeContext.allowDrop ? treeContext.allowDrop(key.value, dropPosition.value) : true;\n  });\n  return {\n    isDragOver,\n    isDragging,\n    isAllowDrop,\n    dropPosition,\n    setDragStatus(status, e) {\n      switch (status) {\n        case \"dragStart\":\n          isDragging.value = true;\n          dropPosition.value = 0;\n          treeContext.onDragStart && treeContext.onDragStart(key.value, e);\n          break;\n        case \"dragEnd\":\n          isDragging.value = false;\n          isDragOver.value = false;\n          dropPosition.value = 0;\n          updateDropPosition.cancel();\n          treeContext.onDragEnd && treeContext.onDragEnd(key.value, e);\n          break;\n        case \"dragOver\":\n          isDragOver.value = true;\n          updateDropPosition(e);\n          treeContext.onDragOver && treeContext.onDragOver(key.value, e);\n          break;\n        case \"dragLeave\":\n          isDragOver.value = false;\n          dropPosition.value = 0;\n          updateDropPosition.cancel();\n          treeContext.onDragLeave && treeContext.onDragLeave(key.value, e);\n          break;\n        case \"drop\":\n          treeContext.onDrop && treeContext.onDrop(key.value, dropPosition.value, e);\n          isDragOver.value = false;\n          dropPosition.value = 0;\n          updateDropPosition.cancel();\n          break;\n      }\n    }\n  };\n}\nexport { useDraggable as default };\n"],"mappings":"AAAA,SAASA,MAAT,EAAiBC,GAAjB,QAA4B,KAA5B;AACA,SAASC,aAAT,QAA8B,iCAA9B;AACA,OAAOC,cAAP,MAA2B,uBAA3B;;AACA,SAASC,YAAT,CAAsBC,KAAtB,EAA6B;EAC3B,MAAM;IAAEC,GAAF;IAAOC;EAAP,IAAoBP,MAAM,CAACK,KAAD,CAAhC;EACA,MAAMG,WAAW,GAAGL,cAAc,EAAlC;EACA,MAAMM,UAAU,GAAGR,GAAG,CAAC,KAAD,CAAtB;EACA,MAAMS,UAAU,GAAGT,GAAG,CAAC,KAAD,CAAtB;EACA,MAAMU,WAAW,GAAGV,GAAG,CAAC,KAAD,CAAvB;EACA,MAAMW,YAAY,GAAGX,GAAG,CAAC,CAAD,CAAxB;EACA,MAAMY,kBAAkB,GAAGX,aAAa,CAAEY,CAAD,IAAO;IAC9C,IAAI,CAACP,QAAQ,CAACQ,KAAd,EACE;IACF,MAAMC,IAAI,GAAGT,QAAQ,CAACQ,KAAT,CAAeE,qBAAf,EAAb;IACA,MAAMC,OAAO,GAAGC,MAAM,CAACC,WAAP,GAAqBJ,IAAI,CAACK,GAA1C;IACA,MAAM;MAAEC;IAAF,IAAYR,CAAlB;IACA,MAAMS,SAAS,GAAGP,IAAI,CAACQ,MAAL,GAAc,CAAhC;IACA,MAAMC,IAAI,GAAGH,KAAK,GAAGJ,OAArB;IACAN,YAAY,CAACG,KAAb,GAAqBU,IAAI,GAAGF,SAAP,GAAmB,CAAC,CAApB,GAAwBE,IAAI,GAAGT,IAAI,CAACQ,MAAL,GAAcD,SAArB,GAAiC,CAAjC,GAAqC,CAAlF;IACAZ,WAAW,CAACI,KAAZ,GAAoBP,WAAW,CAACkB,SAAZ,GAAwBlB,WAAW,CAACkB,SAAZ,CAAsBpB,GAAG,CAACS,KAA1B,EAAiCH,YAAY,CAACG,KAA9C,CAAxB,GAA+E,IAAnG;EACD,CAVuC,CAAxC;EAWA,OAAO;IACLN,UADK;IAELC,UAFK;IAGLC,WAHK;IAILC,YAJK;;IAKLe,aAAa,CAACC,MAAD,EAASd,CAAT,EAAY;MACvB,QAAQc,MAAR;QACE,KAAK,WAAL;UACElB,UAAU,CAACK,KAAX,GAAmB,IAAnB;UACAH,YAAY,CAACG,KAAb,GAAqB,CAArB;UACAP,WAAW,CAACqB,WAAZ,IAA2BrB,WAAW,CAACqB,WAAZ,CAAwBvB,GAAG,CAACS,KAA5B,EAAmCD,CAAnC,CAA3B;UACA;;QACF,KAAK,SAAL;UACEJ,UAAU,CAACK,KAAX,GAAmB,KAAnB;UACAN,UAAU,CAACM,KAAX,GAAmB,KAAnB;UACAH,YAAY,CAACG,KAAb,GAAqB,CAArB;UACAF,kBAAkB,CAACiB,MAAnB;UACAtB,WAAW,CAACuB,SAAZ,IAAyBvB,WAAW,CAACuB,SAAZ,CAAsBzB,GAAG,CAACS,KAA1B,EAAiCD,CAAjC,CAAzB;UACA;;QACF,KAAK,UAAL;UACEL,UAAU,CAACM,KAAX,GAAmB,IAAnB;UACAF,kBAAkB,CAACC,CAAD,CAAlB;UACAN,WAAW,CAACwB,UAAZ,IAA0BxB,WAAW,CAACwB,UAAZ,CAAuB1B,GAAG,CAACS,KAA3B,EAAkCD,CAAlC,CAA1B;UACA;;QACF,KAAK,WAAL;UACEL,UAAU,CAACM,KAAX,GAAmB,KAAnB;UACAH,YAAY,CAACG,KAAb,GAAqB,CAArB;UACAF,kBAAkB,CAACiB,MAAnB;UACAtB,WAAW,CAACyB,WAAZ,IAA2BzB,WAAW,CAACyB,WAAZ,CAAwB3B,GAAG,CAACS,KAA5B,EAAmCD,CAAnC,CAA3B;UACA;;QACF,KAAK,MAAL;UACEN,WAAW,CAAC0B,MAAZ,IAAsB1B,WAAW,CAAC0B,MAAZ,CAAmB5B,GAAG,CAACS,KAAvB,EAA8BH,YAAY,CAACG,KAA3C,EAAkDD,CAAlD,CAAtB;UACAL,UAAU,CAACM,KAAX,GAAmB,KAAnB;UACAH,YAAY,CAACG,KAAb,GAAqB,CAArB;UACAF,kBAAkB,CAACiB,MAAnB;UACA;MA7BJ;IA+BD;;EArCI,CAAP;AAuCD;;AACD,SAAS1B,YAAY,IAAI+B,OAAzB"},"metadata":{},"sourceType":"module"}